"use strict";angular.module("adminApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.tinymce"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/News",{templateUrl:"views/news.html",controller:"NewsCtrl"}).when("/Pages",{templateUrl:"views/pages.html",controller:"PagesCtrl"}).when("/Blog",{templateUrl:"views/blog.html",controller:"BlogCtrl"}).when("/Pub",{templateUrl:"views/Pub.html",controller:"PubCtrl"}).otherwise({redirectTo:"/"}),b.html5Mode(!1).hashPrefix("!")}]),angular.module("adminApp").controller("MainCtrl",["$scope","$location","User",function(a,b,c){var d=function(){return!1};d()&&alert("Imagine being redirected to the News page"),a.login=function(){var a=document.getElementById("login-email").value,d=document.getElementById("login-password").value,e=c.login(a,d);e.success===!0?b.path("/News"):document.getElementById("login-errors").innerHTML=e.error},a.signup=function(){var a=document.getElementById("signup-email").value,b=document.getElementById("signup-password").value,d=document.getElementById("signup-confirm").value,e=document.getElementById("signup-name").value,f=document.getElementById("signup-signature").value,g=c.signup(a,b,d,e,f);g.success===!0?alert("Merci de votre enregistrement. Vous recevrez un email lorsque votre candidature sera validée."):document.getElementById("signup-errors").innerHTML=g.error}}]),angular.module("adminApp").factory("User",function(){return{login:function(a,b){var c="",d=!0;return-1===a.indexOf("@")&&(d=!1,c="Il ne s'agit pas d'un email valide."),""===b&&(d=!1,c="Le champ mot de passe est vide."),""===a&&(d=!1,c="Le champ email est vide."),{success:d,error:c}},signup:function(a,b,c,d,e){var f="",g=!0;return b!==c&&(g=!1,f="Le mot de passe ne correspond pas à la confirmation."),-1===a.indexOf("@")&&(g=!1,f="L'email n'est pas valide."),(""===a||""===b||""===c||""===d||""===e)&&(g=!1,f="Certains champs n'ont pas été remplis."),{success:g,error:f}}}}),angular.module("adminApp").controller("NewsCtrl",["$scope","News",function(a,b){var c=b.getNews(),d=(new Date).getTime()/1e3;a.news=c,a.sendNews=function(){var c=parseInt(document.getElementById("newsId").value),d=document.getElementById("newsTitle").value,e=a.tinyMceContent,f=document.getElementById("newsDate").value,g=document.getElementById("newsMag").checked?1:0;return f=f.split("/"),f=parseInt(new Date(f[1]+"/"+f[0]+"/"+f[2]+"/").getTime()/1e3)+1,d||e||f?(b.save(d,e,f,c,g),void a.addNews()):(alert("Certains champs ne sont pas remplis."),!1)},a.delete=function(a){var c=confirm("Voulez vous vraiment supprimer la News n°"+a+" ?");a=parseInt(a),c&&b.delete(a)},a.addNews=function(){a.currentNews={date:d},document.getElementById("newsId").value="",document.getElementById("newsTitle").value="",a.sendText="Créer News",a.tinyMceContent=c.content},a.modify=function(c){var d=b.getNews(c);a.currentNews=d,document.getElementById("newsTitle").value=d.title,a.sendText="Modifier News",a.tinyMceContent=d.content},a.sendText="Créer News",a.currentNews={date:d},a.tinymceOptions={selector:"textarea",theme:"modern",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking table contextmenu directionality","emoticons template paste textcolor"],toolbar1:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media | forecolor backcolor emoticons",image_advtab:!0}}]),angular.module("adminApp").factory("News",function(){var a=[{id:0,author:"Séb",title:"News n°0 avec super long titre",content:'Mon super text, avec du html: <img src="http://www.google.ch/logos/doodles/2014/annette-von-droste-hulshoffs-217th-birthday-5701007384248320.2-hp.jpg" /><a href="http://tooski.ch"></a>',date:1329390694,mag:1},{id:1,author:"Séb",title:"News n°1",content:'Mon super text, avec du html: <img src="http://www.fricktal24.ch/typo3temp/pics/Ski-Aerni_Luca_01_55d138efee.jpg" /><a href="http://tooski.ch"></a>',date:1319390695,mag:1},{id:2,author:"Séb",title:"News n°2",content:'Mon super text, avec du html: <a href="https://tooski.ch"><img src="http://skiweltcup.tv/wp-content/themes/tvsportnews/images/09-aerni002-klein-swiss-ski.jpg" /></a>',date:1329390696,mag:1},{id:3,author:"Séb",title:"News n°0",content:'Mon super text, avec du html: <img src="http://www.google.ch/logos/doodles/2014/annette-von-droste-hulshoffs-217th-birthday-5701007384248320.2-hp.jpg" /><a href="http://tooski.ch"></a>',date:1339390694,mag:1},{id:4,author:"Séb",title:"News n°1",content:'Mon super text, avec du html: <img src="http://www.fricktal24.ch/typo3temp/pics/Ski-Aerni_Luca_01_55d138efee.jpg" /><a href="http://tooski.ch"></a>',date:1349390695,mag:0},{id:5,author:"Séb",title:"News n°2",content:'Mon super text, avec du html: <a href="https://tooski.ch"><img src="http://skiweltcup.tv/wp-content/themes/tvsportnews/images/09-aerni002-klein-swiss-ski.jpg" /></a>',date:1359390696,mag:0},{id:6,author:"Séb",title:"News n°0",content:'Mon super text, avec du html: <img src="http://www.google.ch/logos/doodles/2014/annette-von-droste-hulshoffs-217th-birthday-5701007384248320.2-hp.jpg" /><a href="http://tooski.ch"></a>',date:1369390694,mag:1},{id:7,author:"Séb",title:"News n°1",content:'Mon super text, avec du html: <img src="http://www.fricktal24.ch/typo3temp/pics/Ski-Aerni_Luca_01_55d138efee.jpg" /><a href="http://tooski.ch"></a>',date:1379390695,mag:1},{id:8,author:"Séb",title:"News n°2",content:'Mon super text, avec du html: <a href="https://tooski.ch"><img src="http://skiweltcup.tv/wp-content/themes/tvsportnews/images/09-aerni002-klein-swiss-ski.jpg" /></a>',date:1389390696,mag:0}];return{getNews:function(b){var c;return isNaN(b)?a:(c=a.filter(function(a){return a.id===b}),c[0])},"delete":function(b){var c;for(c=0;c<a.length;c++)if(a[c].id===b)return a.splice(c,1),!0;return!1},save:function(b,c,d,e,f){var g;if(isNaN(e))a.push({id:a.length,author:"Test",title:b,content:c,date:d,mag:f});else for(g=0;g<a.length;g++)if(a[g].id===e){a[g].content=c,a[g].title=b,a[g].date=d,a[g].mag=f;break}}}}),angular.module("adminApp").controller("PagesCtrl",["$scope","Pages",function(a,b){var c=b.getPages();a.modify=function(c){var d=b.getPages(c);a.currentTitle=d.name,a.activePage=d.id,a.tinyMceContent=d.content},a.delete=function(){var d=a.activePage,e=confirm("Voulez-vous vraiment supprimer la news n°"+d+" ?");e&&(b.delete(d),c=b.getPages(),scope.modify(c[0].id))},a.save=function(){var c=a.activePage,d={id:c,name:a.currentTitle,content:a.tinyMceContent};b.save(c,d)},a.addPage=function(){var c=b.save();a.modify(c.id)},a.currentTitle=c[0].name,a.activePage=c[0].id,a.tinyMceContent=c[0].content,a.pages=c,a.tinymceOptions={selector:"textarea",theme:"modern",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking table contextmenu directionality","emoticons template paste textcolor"],toolbar1:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media | forecolor backcolor emoticons",image_advtab:!0}}]),angular.module("adminApp").factory("Pages",function(){var a=[{id:0,name:"Publicité",content:"<p>Il n'y a presque rien ici 1 ! </p>"},{id:1,name:"Staff",content:"<p>Il n'y a presque rien ici 2 ! </p>"},{id:2,name:"Nounours",content:"<p>Il n'y a presque rien ici 3 ! </p>"},{id:3,name:"Admin",content:"<p>Il n'y a presque rien ici 4 ! </p>"},{id:4,name:"Jean de La Fontaine",content:"<p>Il n'y a presque rien ici 5 ! </p>"}];return{getPages:function(b){var c;if(!b&&!angular.isNumber(b))return a;for(c=0;c<a.length;c++)if(a[c].id===b)return a[c]},"delete":function(b){var c;for(c=0;c<a.length;c++)if(a[c].id===b)return a.splice(c,1),!0;return!1},save:function(b,c){var d;if(!b&&!angular.isNumber(b)){var b=a.length,c={id:b,name:"Nouvelle page",content:"<p>Contenu de la nouvelle page.</p>"};return a.push(c),c}for(d=0;d<a.length;d++)if(a[d].id===b)return a[d]={id:b,name:c.name,content:c.content},a[d]}}}),angular.module("adminApp").controller("BlogCtrl",["$scope","Bloggers","BlogPosts",function(a,b,c){var d=b.getBloggers();a.select=function(d){var e=b.getBloggers(d);a.activeBlogger=e.id,a.blogger=e,a.blogPosts=c.getPosts(a.activeBlogger),a.currentNews={}},a.addBlog=function(){var c=b.save(null);a.activeBlogger=c.id,a.blogger=c},a.deleteBlog=function(){var c=confirm("Êtes-vous sûr de vouloir supprimer le blog "+a.blogger.name+" ?"),d=a.blogger;return c?(a.bloggers=b.delete(d),a.select(a.bloggers[0].id),!0):!1},a.saveBlogger=function(){var c=a.activeBlogger,d=a.blogger;b.save(c,d)},a.removeSponsor=function(b){var c=a.blogger.sponsors.indexOf(b);a.blogger.sponsors.splice(c,1)},a.removeAd=function(b){var c=a.blogger.ad.indexOf(b);a.blogger.ad.splice(c,1)},a.changePortrait=function(b){a.$apply(function(){console.log("files:",b.files);b.files})},a.addSponsors=function(b){a.$apply(function(){console.log("files:",b.files);b.files})},a.addAd=function(b){a.$apply(function(){console.log("files:",b.files);b.files})},a.addNews=function(){a.currentNews={date:parseInt((new Date).getTime()/1e3),blogId:a.activeBlogger}},a.modifyNews=function(b){a.currentNews=b},a.saveNews=function(){var b=a.currentNews;b.date=b.date||parseInt((new Date).getTime()/1e3),c.save(b),a.blogPosts=c.getPosts(b.blogId)},a.deleteNews=function(b){var d=confirm("Voulez-vous vraiment effacer le post n°"+b+" ?"),e=a.activeBlogger;return d?(a.blogPosts=c.delete(b,e),!0):!1},a.bloggers=d,a.activeBlogger=d[0].id,a.blogger=d[0],a.blogPosts=c.getPosts(a.activeBlogger),a.currentNews={date:parseInt((new Date).getTime()/1e3),blogId:a.activeBlogger},a.tinymceOptionsBio={selector:"#bioContent",theme:"modern",toolbar1:"bold italic | alignleft aligncenter alignright alignjustify | bullist",image_advtab:!0},a.tinymceOptionsNews={selector:"#newsContent",theme:"modern",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking table contextmenu directionality","emoticons template paste textcolor"],toolbar1:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media | forecolor backcolor emoticons",image_advtab:!0}}]),angular.module("adminApp").factory("Bloggers",function(){var a=[{id:0,name:"Axel Béguelin",linkResults:"http://data.fis-ski.com/dynamic/athlete-biography.html?sector=AL&competitorid=190056&type=result",profilePic:"http://www.arcinfo.ch/multimedia/images/archives_arcinfo//2010.04.09/axel_beguelin.jpg",biography:"Né: 12.12.12 <br /> Mange des petits poids au petit déjeuner. <br /> Il y a beaucoup de petits dans la phrase précédente, mais au moins elle n'est pas trop courte.",sponsors:["http://snow.co.nz/media/uploads/2012/06/logo-atomic.jpg","http://3.bp.blogspot.com/_8cOgwU34ueU/TH6rXYo9kBI/AAAAAAAABaQ/ueZjXw7bpYk/s1600/fi_main-logo_4c_high.jpg","http://www.daillon.ch/wordpress/wp-content/uploads/2013/10/1357755346.jpg"],ad:["http://www.vitagora.com/assets/images/logos/Laiterie_de_bresse_logo.jpg","http://www.pole-formation-savoie.fr/uploads/images/UIMM_PF_SAADOSIS.jpg","http://www.daillon.ch/wordpress/wp-content/uploads/2013/10/1357755346.jpg"]},{id:1,name:"Antoine Perrotet",linkResults:"http://data.fis-ski.com/dynamic/athlete-biography.html?sector=AL&competitorid=190056&type=result",profilePic:"http://www.arcinfo.ch/multimedia/images/archives_arcinfo//2010.04.09/axel_beguelin.jpg",biography:"Né: 12.12.12 <br /> Mange des petits poids au petit déjeuner. <br /> Il y a beaucoup de petits dans la phrase précédente, mais au moins elle n'est pas trop courte.",sponsors:["http://snow.co.nz/media/uploads/2012/06/logo-atomic.jpg","http://www.vitagora.com/assets/images/logos/Laiterie_de_bresse_logo.jpg","http://www.pole-formation-savoie.fr/uploads/images/UIMM_PF_SAADOSIS.jpg"],ad:["http://snow.co.nz/media/uploads/2012/06/logo-atomic.jpg","http://www.pole-formation-savoie.fr/uploads/images/UIMM_PF_SAADOSIS.jpg","http://www.daillon.ch/wordpress/wp-content/uploads/2013/10/1357755346.jpg"]},{id:2,name:"Jean de La Fontaine",linkResults:"http://data.fis-ski.com/dynamic/athlete-biography.html?sector=AL&competitorid=190056&type=result",profilePic:"http://www.arcinfo.ch/multimedia/images/archives_arcinfo//2010.04.09/axel_beguelin.jpg",biography:"Né: 12.12.12 <br /> Mange des petits poids au petit déjeuner. <br /> Il y a beaucoup de petits dans la phrase précédente, mais au moins elle n'est pas trop courte.",sponsors:["http://snow.co.nz/media/uploads/2012/06/logo-atomic.jpg","http://3.bp.blogspot.com/_8cOgwU34ueU/TH6rXYo9kBI/AAAAAAAABaQ/ueZjXw7bpYk/s1600/fi_main-logo_4c_high.jpg","http://www.daillon.ch/wordpress/wp-content/uploads/2013/10/1357755346.jpg"],ad:["http://www.pole-formation-savoie.fr/uploads/images/UIMM_PF_SAADOSIS.jpg","http://3.bp.blogspot.com/_8cOgwU34ueU/TH6rXYo9kBI/AAAAAAAABaQ/ueZjXw7bpYk/s1600/fi_main-logo_4c_high.jpg","http://www.vitagora.com/assets/images/logos/Laiterie_de_bresse_logo.jpg"]}];return{getBloggers:function(b){var c;if(b||angular.isNumber(b))for(c=0;c<a.length;c++)if(a[c].id===b)return a[c];return a},"delete":function(b){var c,d=b.id;for(c=0;c<a.length;c++)if(a[c].id===d)return a.splice(c,1),a;return a},save:function(b,c){var d;if(!b&&!angular.isNumber(b)){var b=a.length,c={id:b,name:"Nouveau Blogger",linkResults:"",profilePic:"",biography:"",sponsors:[],ad:[]};return a.push(c),c}for(d=0;d<a.length;d++)if(a[d].id===b)return a[d]=c,a[d]}}}),angular.module("adminApp").factory("BlogPosts",function(){var a=[{id:0,blogId:0,title:"News n°0 avec super long titre",content:'Mon super text, avec du html: <img src="http://www.google.ch/logos/doodles/2014/annette-von-droste-hulshoffs-217th-birthday-5701007384248320.2-hp.jpg" /><a href="http://tooski.ch"></a>',date:1329390694},{id:1,blogId:0,title:"News n°1 avec super long titre",content:'Mon super text, avec du html: <img src="http://www.google.ch/logos/doodles/2014/annette-von-droste-hulshoffs-217th-birthday-5701007384248320.2-hp.jpg" /><a href="http://tooski.ch"></a>',date:1329390694},{id:2,blogId:1,title:"News n°2 avec super long titre",content:'Mon super text, avec du html: <img src="http://www.google.ch/logos/doodles/2014/annette-von-droste-hulshoffs-217th-birthday-5701007384248320.2-hp.jpg" /><a href="http://tooski.ch"></a>',date:1329390694},{id:3,blogId:2,title:"News n°3 avec super long titre",content:'Mon super text, avec du html: <img src="http://www.google.ch/logos/doodles/2014/annette-von-droste-hulshoffs-217th-birthday-5701007384248320.2-hp.jpg" /><a href="http://tooski.ch"></a>',date:1329390694}];return{"delete":function(b,c){var d,e=[];for(d=0;d<a.length;d++)a[d].blogId===c&&(a[d].id===b?(a.splice(d,1),d--):e.push(a[d]));return e},save:function(b){var c;if(!b.id&&!angular.isNumber(b.id))return b.id=a.length,a.push(b),!0;for(c=0;c<a.length;c++)if(a[c].id===b.id)return a[c]=b,!0;return!1},getPosts:function(b,c){var d,e=[];for(d=0;d<a.length;d++)a[d].blogId===b&&e.push(a[d]);return e}}}),angular.module("adminApp").directive("tsImageUpload",function(){return{template:"<div></div>",restrict:"EACM",link:function(a,b){b.text("this is the tsImageUpload directive")}}}),angular.module("adminApp").controller("PubCtrl",["$scope","Pub",function(a,b){var c=function(){a.verticals=b.getCat("vertical"),a.horizontals=b.getCat("horizontal")};a.removeImage=function(a){b.remove(a),c()},c()}]),angular.module("adminApp").factory("Pub",function(){var a=[{id:0,img:"http://placehold.it/750x250",vertical:0,horizontal:1},{id:1,img:"http://placehold.it/750x250",vertical:0,horizontal:1},{id:2,img:"http://placehold.it/250x750",vertical:1,horizontal:0},{id:3,img:"http://placehold.it/250x750",vertical:1,horizontal:0},{id:4,img:"http://placehold.it/750x250",vertical:0,horizontal:1}];return{remove:function(b){var c=a.indexOf(b);return a.splice(c,1),a},getPub:function(b){return b||angular.isNumber(b)?a.filter(function(a){return a.id===b}):a},getCat:function(b){return a.filter(function(a){return 1===a[b]})}}});